<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Report with Chart</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
  <h1>PDF Report Example</h1>
  <canvas id="myChart" width="400" height="200"></canvas>
  <button id="generatePDF">Download PDF</button>

  <script>
    // Step 1: Render Chart using Chart.js
    const ctx = document.getElementById('myChart').getContext('2d');
    const myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
        datasets: [{
          label: '# of Votes',
          data: [12, 19, 3, 5, 2, 3],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)',
            'rgba(75, 192, 192, 0.2)',
            'rgba(153, 102, 255, 0.2)',
            'rgba(255, 159, 64, 0.2)',
          ],
          borderColor: [
            'rgba(255, 99, 132, 1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)',
            'rgba(153, 102, 255, 1)',
            'rgba(255, 159, 64, 1)',
          ],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // Step 2: Generate PDF Report
    document.getElementById('generatePDF').addEventListener('click', async () => {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({
        orientation: 'portrait',
        unit: 'px',
        format: 'a4',
      });

      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();

      // Title
      pdf.setFont('helvetica', 'bold');
      pdf.setFontSize(20);
      pdf.text('Report with Chart and Table', pageWidth / 2, 40, { align: 'center' });

      // Chart Image
      const chartCanvas = document.getElementById('myChart');
      const chartImage = chartCanvas.toDataURL('image/png');
      const chartWidth = 300;
      const chartHeight = 150;
      pdf.addImage(chartImage, 'PNG', (pageWidth - chartWidth) / 2, 60, chartWidth, chartHeight);

      // Text Content
      pdf.setFont('helvetica', 'normal');
      pdf.setFontSize(12);
      pdf.text('This is a sample report containing a chart and a table.', 40, 240);
      pdf.text('The chart above shows sample data in a bar format.', 40, 260);

      // Table Data
      const tableData = [
        ['Item', 'Quantity', 'Price'],
        ['Product A', '2', '$50'],
        ['Product B', '1', '$73.45'],
        ['Product C', '5', '$25.00'],
      ];

      pdf.autoTable({
        startY: 280,
        head: [tableData[0]],
        body: tableData.slice(1),
      });

      // Footer
      pdf.setFontSize(10);
      pdf.text(`Generated on ${new Date().toLocaleDateString()}`, pageWidth / 2, pageHeight - 30, {
        align: 'center',
      });

      // Save the PDF
      pdf.save('report_with_chart.pdf');
    });
  </script>
</body>
</html>
